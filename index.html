<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Target Number Game</title>

<style>
:root{
  --bg1:#1a6ed8;
  --bg2:#3fa9f5;
  --panel:#0f2f57;
  --num:#1f8fff;
  --numShadow:#0c4fa3;
  --opAdd:#2ecc71;
  --opSub:#f39c12;
  --opMul:#9b59b6;
  --opDiv:#e74c3c;
  --btn:#34495e;
  --btnShadow:#1f2d3a;
  --white:#fff;
}

html,body{
  height:100%;margin:0;font-family:system-ui;
  background:linear-gradient(160deg,var(--bg1),var(--bg2));
  color:white;display:flex;align-items:center;justify-content:center;
}
.container{
  width:960px;max-width:96vw;padding:18px;
  background:var(--panel);border-radius:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.45);position:relative;
}
.header{display:flex;justify-content:space-between;align-items:center;}
.title{font-size:22px;font-weight:800;}
.settings{display:flex;gap:8px;align-items:center;font-size:14px;}
select{padding:6px 8px;border-radius:8px;border:none;background:#224a7c;color:white;}
.row{display:flex;justify-content:center;align-items:center;gap:14px;margin:16px 0;flex-wrap:wrap;}
.target{background:#08213f;padding:10px 18px;border-radius:10px;font-size:30px;font-weight:900;color:#ff7676;min-width:90px;text-align:center;}
.num,.op,.btn{border:none;color:white;font-weight:800;cursor:pointer;border-radius:16px;transition:transform .05s, box-shadow .05s, filter .05s;}
.num{min-width:150px;padding:30px;font-size:42px;background:var(--num);box-shadow:0 8px var(--numShadow);} 
.op{min-width:100px;padding:24px;font-size:34px;box-shadow:0 7px rgba(0,0,0,.35);} 
.op.add{background:var(--opAdd);} .op.sub{background:var(--opSub);} .op.mul{background:var(--opMul);} .op.div{background:var(--opDiv);} 
.btn{background:var(--btn);padding:10px 16px;box-shadow:0 6px var(--btnShadow);} 
.num:active,.op:active,.btn:active{transform:translateY(4px);box-shadow:0 3px rgba(0,0,0,.4);} 
.selected{filter:brightness(1.4);} 
.disabled{opacity:.4;pointer-events:none;} 
.solutionBox{margin-top:10px;background:rgba(0,0,0,.35);padding:10px;border-radius:8px;font-size:14px;} 
.fireworks{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:64px;pointer-events:none;animation:pop 2s ease-out forwards;} 
@keyframes pop{0%{opacity:0;transform:scale(.6);}20%{opacity:1;}100%{opacity:0;}}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="title">Target Number Game</div>
    <div class="settings">
      <button id="newGameBtn" class="btn">New Game</button>
      Mode <select id="modeSel"><option value="3">3</option><option value="4" selected>4</option></select>
      Max <select id="maxSel"><option value="50">50</option><option value="99" selected>99</option></select>
      <button id="startBtn" class="btn">Start Game</button>
    </div>
  </div>

  <div class="row">
    Target <div class="target" id="target">--</div>
    Score <span id="score">0</span>
    Problem <span id="problem">0/10</span>
  </div>

  <div class="row">
    <button class="op add" data-op="+">+</button>
    <button class="op sub" data-op="-">âˆ’</button>
    <button class="op mul" data-op="*">Ã—</button>
    <button class="op div" data-op="/">Ã·</button>
  </div>

  <div class="row" id="nums"></div>

  <div class="row">
    <button id="hintBtn" class="btn disabled">Hint</button>
    <button id="solutionBtn" class="btn disabled">Show Solution</button>
    <button id="resetBtn" class="btn disabled">Reset</button>
    <button id="nextBtn" class="btn disabled">New Problem</button>
  </div>

  <div id="solutionBox" class="solutionBox" style="display:none"></div>
</div>

<script>
/* ---------------- STATE ---------------- */
const S={started:false,mode:4,max:99,numbers:[],orig:[],target:0,score:0,problem:0,sel:{a:null,op:null},usedHint:false};

/* ---------------- HELPERS ---------------- */
const r=n=>Math.floor(Math.random()*(n+1));
function genNums(n){let a=[],z=false;while(a.length<n){let v=Math.random()<0.05?0:r(10);if(v===0&&z)continue;if(v===0)z=true;a.push(v);}return a;}

function solve(nums,t){
  if(nums.length===1) return nums[0]===t?[]:null;
  for(let i=0;i<nums.length;i++)for(let j=0;j<nums.length;j++){
    if(i===j)continue;const a=nums[i],b=nums[j];
    const rest=nums.filter((_,k)=>k!==i&&k!==j);
    const ops=[[a+b,'+'],[a*b,'*'],[a-b,'-'],[b-a,'-']];
    if(b!==0&&a%b===0)ops.push([a/b,'/']);
    if(a!==0&&b%a===0)ops.push([b/a,'/']);
    for(const[o,op] of ops){if(!Number.isInteger(o))continue;const r2=solve([o,...rest],t);if(r2)return[{i,j,op},...r2];}
  }
  return null;
}

/* ---------------- GAME FLOW ---------------- */
function startGame(){S.started=true;lock(true);S.problem=0;S.score=0;next();}
function newGame(){S.started=false;lock(false);clear();update();}
function next(){clear();S.problem++;update();makeProblem();}

function makeProblem(){
  while(true){
    const nums=genNums(S.mode);
    for(let k=0;k<80;k++){
      const t=r(S.max);
      if(nums.includes(t))continue;
      if(solve(nums.slice(),t)){
        S.numbers=nums.slice();S.orig=nums.slice();S.target=t;render();enable();return;
      }
    }
  }
}

/* ---------------- UI ---------------- */
const numsDiv=document.getElementById('nums');
function render(){
  document.getElementById('target').textContent=S.target;
  numsDiv.innerHTML='';
  S.numbers.forEach((n,i)=>{
    const b=document.createElement('button');b.className='num';b.textContent=n;
    b.onclick=()=>numClick(i,b);numsDiv.appendChild(b);
  });
}

function numClick(i,b){
  if(S.sel.a===null){S.sel.a=i;b.classList.add('selected');return;}
  if(S.sel.op!==null){apply(i);} }

function apply(j){
  const i=S.sel.a;const op=S.sel.op;
  let a=S.numbers[i],b=S.numbers[j],v;
  if(op==='+' )v=a+b;
  if(op==='*' )v=a*b;
  if(op==='-' )v=a-b;
  if(op==='/' ){if(b===0||a%b!==0)return;v=a/b;}
  S.numbers.splice(Math.max(i,j),1);
  S.numbers.splice(Math.min(i,j),1,v);
  S.sel={a:null,op:null};render();check();
}

function check(){
  if(S.numbers.length===1&&S.numbers[0]===S.target){
    S.score+=S.usedHint?(S.mode===3?50:70):100;
    update();fire();document.getElementById('nextBtn').classList.remove('disabled');disable();
  }
}

/* ---------------- OPS ---------------- */
document.querySelectorAll('.op').forEach(b=>b.onclick=()=>{
  if(S.sel.a!==null){S.sel.op=b.dataset.op;}});

/* ---------------- BUTTONS ---------------- */
function enable(){['hintBtn','solutionBtn','resetBtn'].forEach(id=>document.getElementById(id).classList.remove('disabled'));}
function disable(){['hintBtn','solutionBtn','resetBtn'].forEach(id=>document.getElementById(id).classList.add('disabled'));}

function clear(){numsDiv.innerHTML='';document.getElementById('target').textContent='--';document.getElementById('solutionBox').style.display='none';}
function update(){document.getElementById('score').textContent=S.score;document.getElementById('problem').textContent=S.problem+'/10';}
function lock(v){document.getElementById('modeSel').disabled=v;document.getElementById('maxSel').disabled=v;document.getElementById('startBtn').disabled=v;}
function fire(){const f=document.createElement('div');f.className='fireworks';f.textContent='ðŸŽ†ðŸŽ‡';document.querySelector('.container').appendChild(f);setTimeout(()=>f.remove(),2000);} 

/* ---------------- EVENTS ---------------- */
document.getElementById('startBtn').onclick=startGame;
document.getElementById('newGameBtn').onclick=newGame;
document.getElementById('nextBtn').onclick=()=>{if(S.problem<10)next();};
document.getElementById('resetBtn').onclick=()=>{S.numbers=S.orig.slice();render();};
document.getElementById('hintBtn').onclick=()=>{S.usedHint=true;alert('Try combining the two smallest numbers first.');};
document.getElementById('solutionBtn').onclick=()=>{document.getElementById('solutionBox').style.display='block';document.getElementById('solutionBox').textContent='One valid solution exists.';document.getElementById('nextBtn').classList.remove('disabled');disable();};
document.getElementById('modeSel').onchange=e=>S.mode=+e.target.value;
document.getElementById('maxSel').onchange=e=>S.max=+e.target.value;
</script>
</body>
</html>
